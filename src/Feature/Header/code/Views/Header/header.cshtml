@using Sitecore.Mvc
@using Sitecore.Mvc.Presentation
@using AuthenticationManager = Sitecore.Security.Authentication.AuthenticationManager
@model RenderingModel
@{
  var homeItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Home");

  var productsCatalogItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Products Catalog");
  var allProductsItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/All Products");
  var topProductsItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Top Products");
  var archiveProductsItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Archive Products");

  var contactsItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Contacts");

  var registrationItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Authentication/Registration");
  var loggingItem = Sitecore.Context.Database.Items.GetItem("/sitecore/Content/BMW/Authentication/Logging");
}

<header>
  <div class="header-container">
    <div class="header-logo">@Html.Sitecore().Field("Header Logo")</div>

    <div class="header-navbar">
      <a href="@Sitecore.Links.LinkManager.GetItemUrl(homeItem)">@Html.Sitecore().Field("Page Title", homeItem)</a>

      <div class="header-dropdown">
        <button class="header-dropbtn">
          @Html.Sitecore().Field("Title", productsCatalogItem)<i class="fa fa-caret-down"></i>
        </button>

        <div class="header-dropdown-content">
          @if (allProductsItem != null)
          {
            <a href="@Sitecore.Links.LinkManager.GetItemUrl(allProductsItem)">
              @Html.Sitecore().Field("Page Title", allProductsItem)
            </a>
          }

          @if (topProductsItem != null)
          {
            <a href="@Sitecore.Links.LinkManager.GetItemUrl(topProductsItem)">
              @Html.Sitecore().Field("Page Title", topProductsItem)
            </a>
          }

          @if (archiveProductsItem != null)
          {
            <a href="@Sitecore.Links.LinkManager.GetItemUrl(archiveProductsItem)">
              @Html.Sitecore().Field("Page Title", archiveProductsItem)
            </a>
          }
        </div>
      </div>

      <a href="@Sitecore.Links.LinkManager.GetItemUrl(contactsItem)">@Html.Sitecore().Field("Page Title", contactsItem)</a>
    
      <div class="header-auth-button">
        <style>
          .registration,
          .logging-in,
          .logging-out {
              float: right;
              background-color: blue;
              font-size: 18px;
              color: white;
              text-align: center;
              padding: 30px 30px;
          }
        </style>
        @if (!Request.IsAuthenticated)
        {
          <button class="registration" onclick="openUrl('@Sitecore.Links.LinkManager.GetItemUrl(registrationItem)')">
            Registration
          </button>
        
          <button class="logging-in" onclick="openUrl('@Sitecore.Links.LinkManager.GetItemUrl(loggingItem)')">
            Log in
          </button>
        }
        else
        {
          // TODO fix logout mechanism
          /*<button class="logging-out" onclick="{(event) => this.refreshPage}">
            Log out
          </button>*/
        }
      </div>

      @*Html.Sitecore().Rendering("{2345DCD0-A8E9-476C-9C10-44C440EE66DF}"); 
      <script>
        function refreshPage(){
            @Html.Sitecore().Rendering("{2345DCD0-A8E9-476C-9C10-44C440EE66DF}")
            window.location.reload();
        } 
      </script>*@

      <div>
        <style>
          .user-name {
            color: white;
            text-align: center;
          }
        </style>
        @if (Request.IsAuthenticated)
        {
          <h2 class="user-name">@AuthenticationManager.GetActiveUser().LocalName</h2>
        }
      </div>
      
      <script>
        function openUrl(url) {
          window.location = url;
          window.open(url);
        }
      </script>
    </div>
  </div>
</header>